(()=>{"use strict";var e={52:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}a((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(252);t.default=class{constructor(e){this.router=(0,s.Router)(),this.userLoginUseCase=e,this.routes()}routes(){this.router.post("/",this.login.bind(this))}login(e,t){return r(this,void 0,void 0,(function*(){const{email:n,password:r}=e.body;try{const e=yield this.userLoginUseCase.login(n,r);return t.status(200).json({success:!0,token:e})}catch(e){return t.status(400).json({success:!1,error:"Invalid credentials"})}}))}}},865:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}a((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(368);t.default=class{constructor(e){this.user=e}findBYEmail(e){return r(this,void 0,void 0,(function*(){const t=yield s.db.user.findFirst({where:{email:e}});return t?{id:t.id,name:t.name,lastname:t.lastname,username:t.username,email:t.email,password:t.password,isDeleted:t.isDeleted,createdAt:t.createdAt,updatedAt:t.updatedAt}:null}))}}},394:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(829));n(469),t.default=class{constructor(){this.secret=process.env.JWT_SECRET}generateToken(e){return s.default.sign(e,this.secret,{expiresIn:"1h"})}verifyToken(e){return s.default.verify(e,this.secret)}}},859:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(252)),i=r(n(577)),o=r(n(865)),u=r(n(394)),a=r(n(502)),c=r(n(52)),l=r(n(633)),d=(0,s.default)();d.use(s.default.json());const f=new l.default,h=new o.default(f),p=new u.default,v=new a.default(h,p),_=new c.default(v);d.use((0,i.default)()),d.use("/login",_.router),t.default=d},502:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(n(486));t.default=class{constructor(e,t){this.userRepository=e,this.jwtService=t}login(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.userRepository.findBYEmail(e);if(!i.default.compareSync(t,n.password)||!n)throw new Error("Invalid credentials");return this.jwtService.generateToken({id:n.id})}))}}},633:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.id=0,this.name="",this.lastname="",this.username="",this.email="",this.password="",this.isDeleted=!1,this.createdAt=new Date,this.updatedAt=new Date}}},368:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.db=void 0;const r=n(330);let s;global.__db||(global.__db=new r.PrismaClient),t.db=s=global.__db},997:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(856)),i=r(n(859)),o=s.default.createServer(i.default),u=process.env.PORT||3e3;o.listen(u,(()=>{console.log(`Server is running on port ${u}`)}))},330:e=>{e.exports=require("@prisma/client")},486:e=>{e.exports=require("bcrypt")},577:e=>{e.exports=require("cors")},469:e=>{e.exports=require("dotenv/config")},252:e=>{e.exports=require("express")},856:e=>{e.exports=require("http")},829:e=>{e.exports=require("jsonwebtoken")}},t={};!function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(997)})();