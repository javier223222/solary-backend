(()=>{"use strict";var e={178:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(252)),i=o(r(394)),a=n.default.Router(),d=new i.default;t.default=class{constructor(e){this.anomalyService=e,a.get("/",((e,t)=>s(this,void 0,void 0,(function*(){try{const{page:r,limit:s}=e.query,{idSpeceficProduct:o}=d.verifyToken(e.headers.authorization),n=yield this.anomalyService.get(o,Number(r),Number(s));t.status(200).send(n)}catch(e){t.status(500).send({message:e.message})}}))))}getrouter(){return a}}},850:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(252)),i=o(r(394)),a=n.default.Router(),d=new i.default;t.default=class{constructor(e,t){this.sensorDataUseCase=e,this.staclient=t,a.get("/histogram",((e,t)=>s(this,void 0,void 0,(function*(){try{let r,s={success:!1,message:""};const{idSpeceficProduct:o}=d.verifyToken(e.headers.authorization),{year:n,month:i,typeSensorId:a}=e.query;if(!a)return s.message="typeSensorId is required",t.status(400).json(s);if(r=i&&n?yield this.sensorDataUseCase.getByDate(o,Number(n),Number(i),Number(a)):n?yield this.sensorDataUseCase.getByYear(o,Number(n),Number(a)):yield this.sensorDataUseCase.get(o,Number(a)),0===r.length)return s={success:!0,message:"Data found ",histogram:[]},t.status(404).json(s);const{label:c,data:u}=yield this.staclient.calculateHistogram(r,e.headers.authorization);return s=i&&n?{success:!0,message:"Data found",label:c,data:u,nameSensor:r[0].nameSensor,period:`${n}-0${i}`}:{success:!0,message:"Data found",label:c,data:u,nameSensor:r[0].nameSensor},t.status(200).json(s)}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal server error"})}})))),a.get("/scatterplot",((e,t)=>s(this,void 0,void 0,(function*(){try{const{year:r,month:s,typeSensorId:o,typeSensorIdtwo:n}=e.query;let i,a,c={success:!1,message:""};const{idSpeceficProduct:u}=d.verifyToken(e.headers.authorization);if(!o||!n)return c.message="typeSensorId and typeSensorIdtwo is required",t.status(400).json(c);if(s&&r?(i=yield this.sensorDataUseCase.getByDate(u,Number(r),Number(s),Number(o)),a=yield this.sensorDataUseCase.getByDate(u,Number(r),Number(s),Number(n))):r?(i=yield this.sensorDataUseCase.getByYear(u,Number(r),Number(o)),a=yield this.sensorDataUseCase.getByYear(u,Number(r),Number(n))):(i=yield this.sensorDataUseCase.get(u,Number(o)),a=yield this.sensorDataUseCase.get(u,Number(n))),0===i.length||0===a.length)return c={success:!1,message:"Data found ",data:[]},t.status(200).json(c);const{data:l,x:f,y:h}=yield this.staclient.scatterPlot(i,a,e.headers.authorization);return c=s&&r?{success:!0,message:"Data found",data:l,x:f,y:h,period:`${r}-0${s}`}:{success:!0,message:"Data found",data:l,x:f,y:h},t.status(200).json(c)}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal server error"})}})))),a.get("/linachart",((e,t)=>s(this,void 0,void 0,(function*(){try{const{year:r}=e.query;let s;const{idSpeceficProduct:o}=d.verifyToken(e.headers.authorization);if(s=r?yield this.sensorDataUseCase.getByYear(o,Number(r)):yield this.sensorDataUseCase.getByYear(o),0===s.length)return t.status(404).json({success:!1,message:"Data not found"});const n=yield this.staclient.linechart(s,e.headers.authorization);return r?t.status(200).json({success:!0,message:"Data found",data:n,period:r}):t.status(200).json({success:!0,message:"Data found",data:n})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal server error"})}})))),a.get("/freqency",((e,t)=>s(this,void 0,void 0,(function*(){try{const{year:r,month:s}=e.query;let o,n={};const{idSpeceficProduct:i}=d.verifyToken(e.headers.authorization);if(o=r&&s?yield this.sensorDataUseCase.getByDate(i,Number(r),Number(s)):r?yield this.sensorDataUseCase.getByYear(i,Number(r)):yield this.sensorDataUseCase.get(i),0===o.length)return t.status(404).json({success:!1,message:"Data not found"});const a=yield this.staclient.frequencytable(o,e.headers.authorization);return n=r&&s?{success:!0,message:"Data found",data:a,period:`${r}-0${s}`}:r?{success:!0,message:"Data found",data:a,period:r}:{success:!0,message:"Data found",data:a},t.status(200).json(n)}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal server error"})}})))),a.get("/boxplot",((e,t)=>s(this,void 0,void 0,(function*(){try{const{year:r,month:s}=e.query,{idSpeceficProduct:o}=d.verifyToken(e.headers.authorization);let n;n=r&&s?yield this.sensorDataUseCase.getByDate(o,Number(r),Number(s)):r?yield this.sensorDataUseCase.getByYear(o,Number(r)):yield this.sensorDataUseCase.get(o);const i=yield this.staclient.boxplot(n,e.headers.authorization);return t.status(200).json({success:!0,message:"Data found",data:i})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal server error"})}}))))}getrouter(){return a}}},960:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(252)),i=o(r(394)),a=n.default.Router(),d=new i.default;t.default=class{constructor(e,t){this.sensorDataUseCase=e,this.probabilityClient=t,a.get("/temporalseries",((e,t)=>s(this,void 0,void 0,(function*(){try{const{sensorId:r}=e.query;if(!r)return t.status(400).json({success:!1,message:"sensorId is required"});const{idSpeceficProduct:s}=d.verifyToken(e.headers.authorization);let o;o=yield this.sensorDataUseCase.get(s,Number(r));const n=yield this.probabilityClient.temporalSeries(o,e.headers.authorization);return t.status(200).json({success:!0,message:"Data found",data:n})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal Server Error"})}})))),a.get("/sensor_probability",((e,t)=>s(this,void 0,void 0,(function*(){try{const{sensorId:r,thread:s}=e.query;if(!r)return t.status(400).json({success:!1,message:"sensorId is required"});const{idSpeceficProduct:o}=d.verifyToken(e.headers.authorization);let n;n=yield this.sensorDataUseCase.get(o,Number(r));const i=yield this.probabilityClient.probabilitySensor(n,Number(s),e.headers.authorization);return t.status(200).json({success:!0,message:"Data found",data:i})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal Server Error"})}})))),a.get("/predict_detection",((e,t)=>s(this,void 0,void 0,(function*(){try{const{sensorId:r}=e.query;if(!r)return t.status(400).json({success:!1,message:"sensorId is required"});const{idSpeceficProduct:s}=d.verifyToken(e.headers.authorization);let o;o=yield this.sensorDataUseCase.get(s,Number(r));const n=yield this.probabilityClient.predictDetection(o,e.headers.authorization);return t.status(200).json({success:!0,message:"Data found",data:n})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal Server Error"})}})))),a.get("/detect_anomaly",((e,t)=>s(this,void 0,void 0,(function*(){try{const{sensorId:r}=e.query;if(!r)return t.status(400).json({success:!1,message:"sensorId is required"});const{idSpeceficProduct:s}=d.verifyToken(e.headers.authorization);let o;o=yield this.sensorDataUseCase.get(s,Number(r));const n=yield this.probabilityClient.detectanomaly(o,e.headers.authorization);return console.log(n),t.status(200).json({success:!0,message:0!==n.anomalies.length?"deteccion de anomalia en el panel con el sensor especificado"+o[0].nameSensor:"No se detecto ninguna anomalia",data:n,anomalia:0!==n.anomalies.length})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal Server Error"})}})))),a.get("/decta_anomaly_knerest",((e,t)=>s(this,void 0,void 0,(function*(){try{const{sensorId:r,k:s}=e.query;if(!r)return t.status(400).json({success:!1,message:"sensorId is required"});const{idSpeceficProduct:o}=d.verifyToken(e.headers.authorization);let n;n=yield this.sensorDataUseCase.get(o,Number(r));const i=yield this.probabilityClient.detectanmoliByK(n,Number(s),e.headers.authorization);return t.status(200).json({success:!0,data:i,message:0!==i.anomalies.length?"deteccion de anomalia en el panel con el sensor especificado"+n[0].nameSensor:"No se detecto ninguna anomalia",anomalia:0!==i.anomalies.length})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal Server Error"})}})))),a.get("/probabilitybypca",((e,t)=>s(this,void 0,void 0,(function*(){try{const{sensorId:r}=e.query;if(!r)return t.status(400).json({success:!1,message:"sensorId is required"});const{idSpeceficProduct:s}=d.verifyToken(e.headers.authorization);let o;o=yield this.sensorDataUseCase.get(s,Number(r));const n=yield this.probabilityClient.detectanmoliByPca(o,e.headers.authorization);return t.status(200).json({success:!0,data:n,message:0!==n.anomalies.length?"deteccion de probabilidad de  anomalia en el panel "+o[0].nameSensor:"No se detecto ninguna anomalia",anomalia:0!==n.anomalies.length})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal Server Error"})}})))),a.get("/probabilitybymontecarlo",((e,t)=>s(this,void 0,void 0,(function*(){try{const{sensorId:r}=e.query;if(!r)return t.status(400).json({success:!1,message:"sensorId is required"});const{idSpeceficProduct:s}=d.verifyToken(e.headers.authorization);let o;o=yield this.sensorDataUseCase.get(s,Number(r));const n=yield this.probabilityClient.detectanomalyByMonteCarlo(o,e.headers.authorization);return t.status(200).json({success:!0,data:n})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal Server Error"})}})))),a.get("/probabilitybymontecarlo",((e,t)=>s(this,void 0,void 0,(function*(){try{const{sensorId:r}=e.query;if(!r)return t.status(400).json({success:!1,message:"sensorId is required"});const{idSpeceficProduct:s}=d.verifyToken(e.headers.authorization);let o;o=yield this.sensorDataUseCase.get(s,Number(r));const n=yield this.probabilityClient.detectanomalyByMonteCarlo(o,e.headers.authorization);return t.status(200).json({success:!0,data:n})}catch(e){return t.status(500).json({success:!1,message:"Internal Server Error"})}})))),a.get("/probabilitybypoisson",((e,t)=>s(this,void 0,void 0,(function*(){try{const{sensorId:r}=e.query;if(!r)return t.status(400).json({success:!1,message:"sensorId is required"});const{idSpeceficProduct:s}=d.verifyToken(e.headers.authorization);let o;o=yield this.sensorDataUseCase.get(s,Number(r));const n=yield this.probabilityClient.detectanomalyByMethodPoint(o,e.headers.authorization);return t.status(200).json({success:!0,data:n})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal Server Error"})}}))))}getRouter(){return a}}},381:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(252)).default.Router();t.default=class{constructor(e){this.sensorDataUseCase=e,n.post("/sensordata",((e,t)=>s(this,void 0,void 0,(function*(){const{sensorId:r,valor:s,nameSensor:o,codeOfProduct:n}=e.body;try{return yield this.sensorDataUseCase.save({id:0,createdAt:new Date,updatedAt:new Date,isDeleted:!1,valor:s,sensorId:r,nameSensor:o,updatedBy:0,createdBy:0,codeOfProduct:n}),t.status(201).json({success:!0,message:"Data saved successfully"})}catch(e){return console.log(e),t.status(400).json({success:!1,message:"Error saving data"})}}))))}getrouter(){return n}}},876:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(252)),i=o(r(394)),a=n.default.Router(),d=new i.default;t.default=class{constructor(e,t){this.sensorDataUseCase=e,this.staclient=t,a.get("/metricts",((e,t)=>s(this,void 0,void 0,(function*(){try{const{idSpeceficProduct:r}=d.verifyToken(e.headers.authorization),{year:s,month:o}=e.query;let n;if(n=o&&s?yield this.sensorDataUseCase.getByDate(r,Number(s),Number(o)):s?yield this.sensorDataUseCase.getByYear(r,Number(s)):yield this.sensorDataUseCase.getByYear(r),0===n.length)return t.status(200).json({success:!0,message:"Data found ",histogram:[]});const i=yield this.staclient.getStatistics(n,e.headers.authorization);return t.status(200).json({success:!0,message:"Data found",data:i})}catch(e){return console.log(e),t.status(500).json({success:!1,message:"Internal Server Error"})}}))))}getRouter(){return a}}},52:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(252);r(469),t.default=class{constructor(e,t){this.router=(0,o.Router)(),this.userLoginUseCase=e,this.registerUserCase=t,this.routes()}routes(){this.router.post("/login",this.login.bind(this)),this.router.post("/signup",this.register.bind(this))}login(e,t){return s(this,void 0,void 0,(function*(){const{email:r,password:s}=e.body;try{const e=yield this.userLoginUseCase.login(r,s);return t.status(200).json({success:!0,token:e})}catch(e){return console.log(e),t.status(400).json({success:!1,error:"Invalid credentials"})}}))}register(e,t){return s(this,void 0,void 0,(function*(){const{name:r,email:s,password:o,codigoproducto:n}=e.body;try{return yield this.registerUserCase.register({name:r,email:s,password:o,id:0,createdAt:new Date,updatedAt:new Date,isDeleted:!1,roleid:Number(process.env.ROLEID)},n),t.status(201).json({success:!0,message:"User registered successfully"})}catch(e){return console.log(e.message),t.status(400).json({success:!1,message:"Error registering user"})}}))}}},585:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(368);t.default=class{get(e,t,r){return s(this,void 0,void 0,(function*(){try{if(t&&r){const s=yield o.db.anomaly.count({where:{sensorData:{codeOfProduct:e},isDeleted:!1}}),n=Math.ceil(s/r),i=t>n?n:t;return{total:s,totalPages:n,currentpage:i,data:yield o.db.anomaly.findMany({where:{sensorData:{codeOfProduct:e},isDeleted:!1},select:{sensorData:{select:{valor:!0,nameSensor:!0,createdAt:!0,codeOfProduct:!0,sensorId:!0}}},skip:(i-1)*r,take:r})}}return yield o.db.anomaly.findMany({where:{sensorData:{codeOfProduct:e},isDeleted:!1},select:{sensorData:{select:{valor:!0,nameSensor:!0,createdAt:!0,codeOfProduct:!0,sensorId:!0}}}})}catch(e){throw console.log(e),new Error(e)}}))}}},431:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(368);t.default=class{findByName(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.producto.findFirst({where:{nombre:e}});return t?{id:t.id,name:t.nombre,description:t.descripcion,price:t.precio,stock:t.stock,isDeleted:t.isDeleted,createdAt:t.createdAt,updatedAt:t.updatedAt}:null}catch(e){throw new Error("Error finding product")}}))}save(e){return s(this,void 0,void 0,(function*(){try{yield o.db.producto.create({data:{nombre:e.name,descripcion:e.description,stock:e.stock,precio:e.price}})}catch(e){throw new Error("Error saving product")}}))}updateName(e,t){return s(this,void 0,void 0,(function*(){try{yield o.db.producto.update({where:{id:e.id},data:{nombre:e.name}})}catch(e){throw new Error("Errro updating name")}}))}updateDescription(e,t){return s(this,void 0,void 0,(function*(){try{yield o.db.producto.update({where:{id:e.id},data:{descripcion:e.description}})}catch(e){throw new Error("Error updating description")}}))}updateStock(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.producto.findUnique({where:{id:e.id}});yield o.db.producto.update({where:{id:e.id},data:{stock:Number(null==t?void 0:t.stock)-1}})}catch(e){throw new Error("Error updating stock")}}))}delete(e){return s(this,void 0,void 0,(function*(){try{yield o.db.producto.update({where:{id:e.id},data:{isDeleted:!0}})}catch(e){throw new Error("Error deleting product")}}))}fisicalDelete(e){return s(this,void 0,void 0,(function*(){try{yield o.db.producto.delete({where:{id:e.id}})}catch(e){throw new Error("Error deleting product")}}))}find(e,t){return s(this,void 0,void 0,(function*(){try{if(e&&t){const r=yield o.db.producto.count({where:{isDeleted:!1}}),s=Math.ceil(r/t),n=yield o.db.producto.findMany({skip:(e-1)*t,take:t,where:{isDeleted:!1},select:{id:!0,nombre:!0,descripcion:!0,precio:!0,stock:!0,isDeleted:!0,updatedAt:!0,createdAt:!0}});return{totalItems:n.length,currentPage:e,limit:t,totalPages:s,data:n}}const r=yield o.db.producto.findMany({where:{isDeleted:!1},select:{id:!0,nombre:!0,descripcion:!0,precio:!0,stock:!0,isDeleted:!0,updatedAt:!0,createdAt:!0}}),s=[];return r.map((e=>{s.push({id:e.id,name:e.nombre,description:e.descripcion,price:e.precio,stock:e.stock,isDeleted:e.isDeleted,createdAt:e.createdAt,updatedAt:e.updatedAt})})),s}catch(e){throw new Error("Error finding a product ")}}))}findById(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.producto.findUnique({where:{id:e}});return t?{id:t.id,name:t.nombre,description:t.descripcion,price:t.precio,stock:t.stock,isDeleted:t.isDeleted,createdAt:t.createdAt,updatedAt:t.updatedAt}:null}catch(e){throw new Error("Error finding a specific product ")}}))}}},534:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(368);t.default=class{find(e,t){return s(this,void 0,void 0,(function*(){try{if(e&&t){const r=yield o.db.productosOfUser.count({where:{isDeleted:!1}}),s=Math.ceil(r/t);return{data:yield o.db.productosOfUser.findMany({take:t,skip:(e-1)*t,where:{isDeleted:!1}}),limit:t,currentPage:e,totalItems:r,totalPages:s}}return yield o.db.productosOfUser.findMany({where:{isDeleted:!1}})}catch(e){throw new Error("Erro finding product of user")}}))}findById(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.productosOfUser.findUnique({where:{id:e}});return t?{idspecificproduct:t.idSpecifProduct,id:t.id,isDeleted:t.isDeleted,userId:t.userId,updateby:t.updatedBy,createdBy:t.createdBy,createdAt:t.createdAt,updatedAt:t.updatedAt}:null}catch(e){throw new Error("Erro finding product of user")}}))}findBySpecificProduct(e,t,r){return s(this,void 0,void 0,(function*(){try{if(t&&r){const s=yield o.db.productosOfUser.count({where:{idSpecifProduct:e,isDeleted:!1}}),n=Math.ceil(s/r);return{data:yield o.db.productosOfUser.findMany({take:r,skip:(t-1)*r,where:{idSpecifProduct:e,isDeleted:!1}}),limit:r,currentPage:t,totalItems:s,totalPages:n}}return yield o.db.productosOfUser.findMany({where:{idSpecifProduct:e,isDeleted:!1}})}catch(e){throw new Error("Erro finding product of user")}}))}findByUserId(e,t,r){return s(this,void 0,void 0,(function*(){try{if(t&&r){const s=yield o.db.productosOfUser.count({where:{isDeleted:!1,userId:e}}),n=Math.ceil(s/r);return{data:yield o.db.productosOfUser.findMany({take:r,skip:(t-1)*r,where:{userId:e,isDeleted:!1}}),limit:r,currentPage:t,totalItems:s,totalPages:n}}return yield o.db.productosOfUser.findMany({where:{userId:e,isDeleted:!1},select:{id:!0,idSpecifProduct:!0,userId:!0,createdAt:!0}})}catch(e){throw new Error("Erro finding product of user")}}))}save(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.productosOfUser.create({data:{userId:e.userId,idSpecifProduct:e.idspecificproduct,createdBy:e.createdBy,updatedBy:e.updateby},select:{id:!0,idSpecifProduct:!0,userId:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0}});return{id:t.id,idspecificproduct:t.idSpecifProduct,userId:t.userId,isDeleted:t.isDeleted,createdAt:t.createdAt,updatedAt:t.updatedAt,createdBy:t.createdBy,updateby:t.updatedBy}}catch(e){throw console.error(e),new Error("Erro saving product of user")}}))}delete(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.productosOfUser.update({where:{id:e},data:{isDeleted:!0},select:{id:!0,userId:!0,idSpecifProduct:!0,isDeleted:!0,createdAt:!0,createdBy:!0,updatedAt:!0,updatedBy:!0}});return{id:t.id,userId:t.userId,idspecificproduct:t.idSpecifProduct,isDeleted:t.isDeleted,createdAt:t.createdAt,updatedAt:t.updatedAt,createdBy:t.createdBy,updateby:t.updatedBy}}catch(e){throw new Error("Erro deleting product of user")}}))}fisicalDelete(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.productosOfUser.delete({where:{id:e},select:{id:!0,userId:!0,idSpecifProduct:!0,isDeleted:!0,createdAt:!0,createdBy:!0,updatedAt:!0,updatedBy:!0}});return{id:t.id,userId:t.userId,idspecificproduct:t.idSpecifProduct,isDeleted:t.isDeleted,createdAt:t.createdAt,updatedAt:t.updatedAt,createdBy:t.createdBy,updateby:t.updatedBy}}catch(e){throw new Error("Erro deleting product of user")}}))}}},306:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(368);t.default=class{save(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.sensorData.create({data:{valor:e.valor,sensorId:Number(e.sensorId),createdBy:1,updatedBy:1,createdAt:new Date,codeOfProduct:e.codeOfProduct,isDeleted:!1,nameSensor:e.nameSensor}});return Object.assign(Object.assign({},e),{id:t.id,createdAt:t.createdAt,updatedAt:t.updatedAt})}catch(e){throw console.log(e),new Error("Error saving data of sensor ")}}))}get(e,t){return s(this,void 0,void 0,(function*(){try{let r=[],s=[];return t?(s=yield o.db.sensorData.findMany({where:{sensorId:t,isDeleted:!1,codeOfProduct:e},select:{id:!0,sensorId:!0,valor:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0,nameSensor:!0,codeOfProduct:!0},orderBy:{createdAt:"asc"}}),r=s.map((e=>({id:e.id,sensorId:e.sensorId,valor:e.valor,isDeleted:e.isDeleted,createdAt:e.createdAt,updatedAt:e.updatedAt,createdBy:e.createdBy,updatedBy:e.updatedBy,nameSensor:e.nameSensor,codeOfProduct:e.codeOfProduct}))),r):(s=yield o.db.sensorData.findMany({where:{isDeleted:!1,codeOfProduct:e},select:{id:!0,sensorId:!0,valor:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0,nameSensor:!0,codeOfProduct:!0},orderBy:{createdAt:"asc"}}),r=s.map((e=>({id:e.id,sensorId:e.sensorId,valor:e.valor,isDeleted:e.isDeleted,createdAt:e.createdAt,updatedAt:e.updatedAt,createdBy:e.createdBy,updatedBy:e.updatedBy,nameSensor:e.nameSensor,codeOfProduct:e.codeOfProduct}))),r)}catch(e){throw console.log(e),new Error("Error getting data of sensor ")}}))}getByDate(e,t,r,n){return s(this,void 0,void 0,(function*(){try{const s=new Date(t,r-1,1),i=new Date(t,r,0);return(yield o.db.sensorData.findMany({where:{createdAt:{gte:s,lt:i},isDeleted:!1,codeOfProduct:e,sensorId:n||void 0},select:{id:!0,sensorId:!0,valor:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0,nameSensor:!0,codeOfProduct:!0},orderBy:{createdAt:"asc"}})).map((e=>({id:e.id,sensorId:e.sensorId,valor:e.valor,isDeleted:e.isDeleted,createdAt:e.createdAt,updatedAt:e.updatedAt,createdBy:e.createdBy,updatedBy:e.updatedBy,nameSensor:e.nameSensor,codeOfProduct:e.codeOfProduct})))}catch(e){throw console.log(e),new Error("Error getting data of sensor ")}}))}getByYear(e,t,r){return s(this,void 0,void 0,(function*(){try{if(t){const s=new Date(t,0,1),n=new Date(t,12,0);return(yield o.db.sensorData.findMany({where:{createdAt:{gte:s,lt:n},isDeleted:!1,codeOfProduct:e,sensorId:r||void 0},select:{id:!0,sensorId:!0,valor:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0,nameSensor:!0,codeOfProduct:!0},orderBy:{createdAt:"asc"}})).map((e=>({id:e.id,sensorId:e.sensorId,valor:e.valor,isDeleted:e.isDeleted,createdAt:e.createdAt,updatedAt:e.updatedAt,createdBy:e.createdBy,updatedBy:e.updatedBy,nameSensor:e.nameSensor,codeOfProduct:e.codeOfProduct})))}const s=(new Date).getFullYear();return(yield o.db.sensorData.findMany({where:{createdAt:{gte:new Date(s,0,1),lt:new Date(s+1,0,1)},isDeleted:!1,codeOfProduct:e,sensorId:r||void 0},select:{id:!0,sensorId:!0,valor:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0,nameSensor:!0,codeOfProduct:!0},orderBy:{createdAt:"asc"}})).map((e=>({id:e.id,sensorId:e.sensorId,valor:e.valor,isDeleted:e.isDeleted,createdAt:e.createdAt,updatedAt:e.updatedAt,createdBy:e.createdBy,updatedBy:e.updatedBy,nameSensor:e.nameSensor,codeOfProduct:e.codeOfProduct})))}catch(e){throw console.log(e),new Error("Error getting data of sensor ")}}))}}},259:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(368);t.default=class{find(e,t){return s(this,void 0,void 0,(function*(){try{if(!e&&!t)return yield o.db.specifProduct.findMany({where:{isDeleted:!1},select:{codigo:!0,productoId:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0,producto:{select:{id:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,nombre:!0,descripcion:!0,stock:!0}}}});if(e&&t){const r=yield o.db.specifProduct.count({where:{isDeleted:!1}}),s=Math.ceil(r/t),n=yield o.db.specifProduct.findMany({take:t,skip:(e-1)*t,where:{isDeleted:!1},select:{codigo:!0,productoId:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0,producto:{select:{id:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,nombre:!0,descripcion:!0,stock:!0}}}});return{totalItems:n.length,totalPages:s,currentPage:e,data:n,limit:t}}return[]}catch(e){throw new Error("Error finding specific product")}}))}findByCodigo(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.specifProduct.findFirst({where:{isDeleted:!1,codigo:e},select:{codigo:!0,productoId:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0,producto:{select:{id:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,nombre:!0,descripcion:!0,stock:!0}}}});return{isDeleted:t.isDeleted,codigo:t.codigo,productId:t.productoId,createdAt:t.createdAt,updatedAt:t.updatedAt,createdById:t.createdBy,updatedById:t.updatedBy}}catch(e){throw new Error("Error finding specific product by code")}}))}findByProductId(e){return s(this,void 0,void 0,(function*(){try{return yield o.db.specifProduct.findFirst({where:{isDeleted:!1,productoId:e},select:{codigo:!0,productoId:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,createdBy:!0,updatedBy:!0,producto:{select:{id:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,nombre:!0,descripcion:!0,stock:!0}},productosOfUser:{select:{id:!0,userId:!0,user:{select:{id:!0,isDeleted:!0,createdAt:!0,updatedAt:!0,name:!0,email:!0}}}}}})}catch(e){throw new Error("Error finding specific product by product id")}}))}save(e){return s(this,void 0,void 0,(function*(){try{yield o.db.specifProduct.create({data:{codigo:e.codigo,productoId:e.productId,isDeleted:!1,createdAt:new Date,updatedAt:new Date,createdBy:e.createdById,updatedBy:e.updatedById}})}catch(e){throw new Error("Error saving specific product")}}))}delete(e){return s(this,void 0,void 0,(function*(){try{yield o.db.specifProduct.update({where:{codigo:e},data:{isDeleted:!0}})}catch(e){throw new Error("Error deleting specific product")}}))}fisicalDelete(e){return s(this,void 0,void 0,(function*(){try{yield o.db.specifProduct.delete({where:{codigo:e}})}catch(e){throw new Error("Error fisical deleting specific product")}}))}update(e,t){return s(this,void 0,void 0,(function*(){try{yield o.db.specifProduct.update({where:{codigo:e},data:{codigo:t}})}catch(e){throw new Error("Error updating specific product")}}))}updateidproducto(e,t){return s(this,void 0,void 0,(function*(){try{yield o.db.specifProduct.update({where:{codigo:e},data:{productoId:t}})}catch(e){throw new Error("Error updating specific product id")}}))}}},865:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(368);t.default=class{constructor(e){this.user=e}findBYEmail(e){return s(this,void 0,void 0,(function*(){const t=yield o.db.user.findFirst({where:{email:e,isDeleted:!1}});return t?{id:t.id,roleid:t.roleId,name:t.name,email:t.email,password:t.password,isDeleted:t.isDeleted,createdAt:t.createdAt,updatedAt:t.updatedAt}:null}))}save(e){return s(this,void 0,void 0,(function*(){try{const t=yield o.db.user.create({data:{roleId:Number(process.env.ROLEID),name:e.name,email:e.email,password:e.password},select:{id:!0,roleId:!0,name:!0,email:!0,password:!0,isDeleted:!0,createdAt:!0,updatedAt:!0}});return{id:t.id,roleid:t.roleId,name:t.name,email:t.email,password:t.password,isDeleted:t.isDeleted,createdAt:t.createdAt,updatedAt:t.updatedAt}}catch(e){throw console.log(e.message),new Error("Error saving user")}}))}update(e,t){return s(this,void 0,void 0,(function*(){try{yield o.db.user.update({where:{id:e.id,isDeleted:!1},data:t})}catch(e){throw new Error("Error updating user")}}))}updatePassword(e,t){return s(this,void 0,void 0,(function*(){try{yield o.db.user.update({where:{id:e.id,isDeleted:!1},data:{password:t}})}catch(e){throw new Error("Error updating user")}}))}delete(e){return s(this,void 0,void 0,(function*(){try{yield o.db.user.update({where:{id:e.id,isDeleted:!1},data:{isDeleted:!0}})}catch(e){throw new Error("Error deleting user")}}))}fisicalDelete(e){return s(this,void 0,void 0,(function*(){try{yield o.db.user.delete({where:{id:e.id}})}catch(e){throw new Error("Error deleting user")}}))}find(e,t){return s(this,void 0,void 0,(function*(){try{if(e&&t){const r=yield o.db.user.count({where:{isDeleted:!1}}),s=yield o.db.user.findMany({where:{isDeleted:!1},skip:(e-1)*t,take:t,select:{id:!0,roleId:!0,name:!0,email:!0,password:!0,isDeleted:!0,createdAt:!0,updatedAt:!0}}),n=[];return s.forEach((e=>{n.push({id:e.id,roleid:e.roleId,name:e.name,email:e.email,password:e.password,isDeleted:e.isDeleted,createdAt:e.createdAt,updatedAt:e.updatedAt})})),{data:n,currentPage:e,limit:t,totalItems:r,totalPages:Math.ceil(r/t)}}const r=yield o.db.user.findMany({where:{isDeleted:!1},select:{id:!0,name:!0,roleId:!0,email:!0,password:!0,isDeleted:!0,createdAt:!0,updatedAt:!0}}),s=[];return r.forEach((e=>{s.push({id:e.id,roleid:e.roleId,name:e.name,email:e.email,password:e.password,isDeleted:e.isDeleted,createdAt:e.createdAt,updatedAt:e.updatedAt})})),s}catch(e){throw new Error("Error getting users")}}))}findById(e){return s(this,void 0,void 0,(function*(){const t=yield o.db.user.findFirst({where:{id:e,isDeleted:!1},select:{id:!0,roleId:!0,name:!0,email:!0,password:!0,isDeleted:!0,createdAt:!0,updatedAt:!0}});return t?{id:t.id,roleid:t.roleId,name:t.name,email:t.email,password:t.password,isDeleted:t.isDeleted,createdAt:t.createdAt,updatedAt:t.updatedAt}:null}))}}},394:function(e,t,r){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=s(r(829));r(469),t.default=class{constructor(){this.secret=process.env.JWT_SECRET}generateToken(e){return o.default.sign(e,this.secret,{expiresIn:"1h"})}verifyToken(e){return o.default.verify(e,this.secret)}}},859:function(e,t,r){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=s(r(252)),n=s(r(577)),i=s(r(865)),a=s(r(394)),d=s(r(502)),c=s(r(52)),u=s(r(633)),l=s(r(991)),f=s(r(534)),h=s(r(431)),p=s(r(259)),y=s(r(381)),v=s(r(335)),m=s(r(306)),g=s(r(744)),w=r(480),b=r(629),D=s(r(850)),_=s(r(876)),A=s(r(549)),B=s(r(960)),S=s(r(585)),P=s(r(178)),I=(0,o.default)();I.use(o.default.json());const E=new u.default,O=new m.default,j=new w.RabbitMqClient,M=new b.StatsClient,U=new v.default(O,j),N=new y.default(U),C=new i.default(E),x=new f.default,k=new h.default,T=new p.default,R=new a.default,q=new d.default(C,R,x),z=new l.default(C,x,k,T),$=new c.default(q,z),L=new D.default(U,M),J=new _.default(U,M),Y=new A.default,Q=new B.default(U,Y),F=new S.default,H=new P.default(F);I.use((0,n.default)()),I.use("/api/auth",$.router),I.use("/api/sensor",g.default,N.getrouter()),I.use("/api/graphics",g.default,L.getrouter()),I.use("/api/statistics",g.default,J.getRouter()),I.use("/api/probability",g.default,Q.getRouter()),I.use("/api/anomaly",g.default,H.getrouter()),t.default=I},335:function(e,t){var r=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t){this.sensorDataRepository=e,this.rabbitMqClient=t}save(e){return r(this,void 0,void 0,(function*(){let t=yield this.sensorDataRepository.save(e);return yield this.rabbitMqClient.sendMessagge(e),console.log("Datos guardado correctamente",t),e}))}get(e,t){return r(this,void 0,void 0,(function*(){const r=yield this.sensorDataRepository.get(e,t);return console.log(r),r}))}getByDate(e,t,s,o){return r(this,void 0,void 0,(function*(){const r=yield this.sensorDataRepository.getByDate(e,t,s,o);return console.log(r),r}))}getByYear(e,t,s){return r(this,void 0,void 0,(function*(){const r=yield this.sensorDataRepository.getByYear(e,t,s);return console.log(r),r}))}}},502:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(486));t.default=class{constructor(e,t,r){this.userRepository=e,this.jwtService=t,this.productOfUserRepository=r}login(e,t){return s(this,void 0,void 0,(function*(){const r=yield this.userRepository.findBYEmail(e);console.log(r);let s=yield this.productOfUserRepository.findByUserId(r.id);if(!n.default.compareSync(t,r.password)||!r)throw new Error("Invalid credentials");return s=Array(s),this.jwtService.generateToken({id:r.id,role:r.roleid,idSpeceficProduct:s[0][0].idSpecifProduct})}))}}},991:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(486));r(469),t.default=class{constructor(e,t,r,s){this.userRepository=e,this.productofuserrepository=t,this.productoRepository=r,this.specificproductrepository=s}register(e,t){return s(this,void 0,void 0,(function*(){try{console.log(e),e.password=n.default.hashSync(e.password,Number(process.env.SALT));const r=yield this.specificproductrepository.findByCodigo(t.toLowerCase());if(console.log(r),!r)throw new Error("Specific product not found");const s=yield this.userRepository.save(e);console.log("lleg");const o=yield this.productofuserrepository.findBySpecificProduct(t);if(console.log(o),Array.isArray(o)){o.length>0&&(yield this.productofuserrepository.save({id:0,idspecificproduct:t,userId:s.id,createdAt:new Date,updatedAt:new Date,createdBy:s.id,updateby:0,isDeleted:!1}));const e=yield this.specificproductrepository.findByCodigo(t);yield this.productoRepository.updateStock({id:e.productId,isDeleted:!1,createdAt:new Date,updatedAt:new Date,name:"",description:"",stock:0,price:0}),console.log(s.id),yield this.productofuserrepository.save({id:0,idspecificproduct:t,userId:s.id,createdAt:new Date,updatedAt:new Date,createdBy:s.id,updateby:0,isDeleted:!1})}}catch(e){throw console.error(e.message),new Error("Error saving user")}}))}}},633:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.id=0,this.name="",this.email="",this.password="",this.isDeleted=!1,this.createdAt=new Date,this.updatedAt=new Date,this.roleid=0}}},368:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.db=void 0;const s=r(330);let o;global.__db||(global.__db=new s.PrismaClient),t.db=o=global.__db},744:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(394));t.default=(e,t,r)=>s(void 0,void 0,void 0,(function*(){try{if(!(new n.default).verifyToken(e.headers.authorization))return t.status(401).json({success:!1,message:"unauthorizated"});r()}catch(e){return console.log(e),t.status(401).json({success:!1,message:"unauthorizated"})}}))},549:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(938));r(469),t.default=class{temporalSeries(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/probability/temporalSeries`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw console.log(e),new Error(e)}}))}probabilitySensor(e,t,r){return s(this,void 0,void 0,(function*(){try{const s=yield n.default.post(`${process.env.STATS_URL}/api/v1/probability/probabilitysensor`,{sensor_data:e,threshold:t},{headers:{Authorization:`Bearer ${r}`}});return JSON.parse(s.data)}catch(e){throw console.log(e),new Error(e)}}))}predictDetection(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/probability/predictfault`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw console.log(e),new Error(e)}}))}detectanomaly(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/probability/detectanomalies`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw console.log(e),new Error(e)}}))}detectanmoliByK(e,t,r){return s(this,void 0,void 0,(function*(){try{const s=yield n.default.post(`${process.env.STATS_URL}/api/v1/probability/prrobabilityknearest`,{sensor_data:e,k:t},{headers:{Authorization:`Bearer ${r}`}});return JSON.parse(s.data)}catch(e){throw console.log(e),new Error(e)}}))}detectanmoliByPca(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/probability/probabilitypca`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw console.log(e),new Error(e)}}))}detectanomalyByMonteCarlo(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/probability/probabilitybymontecarlo`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw console.log(e),new Error(e)}}))}detectanomalyByMethodPoint(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/probability/probabilitybypoisson`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw console.log(e),new Error(e)}}))}}},480:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RabbitMqClient=void 0;const n=o(r(942));t.RabbitMqClient=class{constructor(){}connect(){return s(this,void 0,void 0,(function*(){this.connection=yield n.default.connect(process.env.RABBITMQ_URL,{username:process.env.RABBITMQ_USERNAME,password:process.env.RABBITMQ_PASSWORD}),this.channel=yield this.connection.createChannel(),yield this.channel.assertQueue(process.env.RABBITMQ_QUEUE)}))}sendMessagge(e){return s(this,void 0,void 0,(function*(){this.channel.sendToQueue(process.env.RABBITMQ_QUEUE,Buffer.from(JSON.stringify(e)))}))}consumeMessages(e){return s(this,void 0,void 0,(function*(){this.channel.consume(process.env.RABBITMQ_QUEUE,(t=>{if(null!==t){const r=JSON.parse(t.content.toString());e(r),this.channel.ack(t)}}))}))}}},629:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StatsClient=void 0;const n=o(r(938));r(469),t.StatsClient=class{calculateHistogram(e,t){return s(this,void 0,void 0,(function*(){const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/stats/histogram`,{sensor_values:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}))}scatterPlot(e,t,r){return s(this,void 0,void 0,(function*(){try{const s=yield n.default.post(`${process.env.STATS_URL}/api/v1/stats/scatter-plot`,{sensor_data1:e,sensor_data2:t},{headers:{Authorization:`Bearer ${r}`}});return JSON.parse(s.data)}catch(e){throw new Error(e)}}))}linechart(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/stats/line-chart`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw new Error(e)}}))}frequencytable(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/stats/frecuencytable`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw new Error(e)}}))}boxplot(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/stats/boxplot`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw new Error(e)}}))}getStatistics(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield n.default.post(`${process.env.STATS_URL}/api/v1/statics/meditions`,{sensor_data:e},{headers:{Authorization:`Bearer ${t}`}});return JSON.parse(r.data)}catch(e){throw new Error(e)}}))}}},997:function(e,t,r){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=s(r(856)),n=s(r(859)),i=s(r(335)),a=s(r(306)),d=r(480),c=new a.default,u=new d.RabbitMqClient,l=(new i.default(c,u),new(s(r(549)).default),o.default.createServer(n.default)),f=process.env.PORT||3e3;l.listen(f,(()=>{console.log(`Server is running on port ${f}`)}))},330:e=>{e.exports=require("@prisma/client")},942:e=>{e.exports=require("amqplib")},938:e=>{e.exports=require("axios")},486:e=>{e.exports=require("bcrypt")},577:e=>{e.exports=require("cors")},469:e=>{e.exports=require("dotenv/config")},252:e=>{e.exports=require("express")},856:e=>{e.exports=require("http")},829:e=>{e.exports=require("jsonwebtoken")}},t={};!function r(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,r),n.exports}(997)})();